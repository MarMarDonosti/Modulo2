<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recetas</title>
    <style>
        @font-face {
            font-family: 'Ananda';
            src: url('Ananda\ Personal\ Use.ttf') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            margin: 0;
        }

        header {
            text-align: center;
            background-color: rgb(239, 210, 143);
            margin: 0;
            display:flex;
            justify-content:flex-start;
            gap: 5em;
            padding: 1em;
            padding-left: 5em;
        }

        .logo {
            width: 8em;
            border-radius: 100px;
        }

        main {
            /*display: grid;
            grid-template-columns: 1fr auto;
            grid-template-areas:
                ""*/
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: rgb(215, 123, 31);
            margin: 0;
        }

        .main-content {
            display: flex;
            justify-content: center;
            gap: 5em; /* Espacio entre imagen y formulario */
            margin-bottom: 2em;
            flex-wrap: wrap; /* Permite que los elementos se ajusten en pantallas pequeñas */
        }

        .cuchillo {
            width: 25em;
            border: solid white 0.5em;
            box-shadow: 0px 9px 8px rgba(0, 0, 0, 0.5);
            align-self:center;
            justify-self: flex-start;
            margin-top: 3em;
        }

        h1 {
            text-align: center;
            font-family: "Ananda";
            font-size: 3.5em;
        }

        h2 {
            text-align: center;
            color: black;
            margin-top: 20px;
            /*text-shadow: 2px 6px 4px rgba(0, 0, 0, 1);*/
        }

        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 430px;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);

        }

        label {
            font-size: 16px;
            margin-bottom: 10px;
            /*display: block;*/
        }

        input[type="text"],
        textarea {
            width: 96%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        input[type="submit"] {
            background-color: #41c7d3;
            color: black;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            /*margin-top: 30px;*/
            width: 200px;
            margin: auto;
            /*display: inline;*/

        }

        input[type="submit"]:hover {
            background-color: #0f6f78;
            color: white;
        }

        #recetasContainer {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .receta {
            background-color: #fff;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 14px 5px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-borrar {
            background-color: red;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        .btn-borrar:hover {
            background-color: darkred;
        }

        footer {
            background-color: rgb(215, 123, 31);
            margin: 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                align-items: center;
            }

            .cuchillo {
                width: 15em;
            }
        }
    </style>
</head>

<body>
    <header>
        <img class="logo" src="logo_cocina.jfif">
        <h1>La venganza de la abuela</h1>
        <!--Aquí va el buscador-->
    </header>
    <main>
        <div class="main-content">
            <figure>
                <img class="cuchillo" src="cuchillo.webp"
                    alt="Imagen de un cuchillo clavado en un tabla de picar verdura">
            </figure>
            <div class="form-container">
                <h2>Cuéntanos tu receta:</h2>
                <form id="formRecetas">
                    <input type="text" id="nombreReceta" aria-label="Nombre de la receta" name="nombreReceta"
                        placeholder="Nombre de la receta" required>
                    <div id="error-message" class="error"></div>

                    <textarea id="ingredientes" aria-label="Ingredientes de la receta" name="ingredientes"
                        placeholder="Ingredientes" rows="5" cols="50"></textarea>

                    <textarea id="pasos" aria-label="Pasos de preparación" name="pasos"
                        placeholder="Pasos de preparación" rows="10" cols="50"></textarea>

                    <input type="submit" id="btnEnviar" value="Guardar receta">
                </form>
            </div>
        </div>
        <h3>Recetas Guardadas</h3>
        <div id="recetasContainer"></div>
    </main>
    <footer>
        <p>Esta página se ha realizado en memoria de Gorka y la amoña Ángeles.</p>
    </footer>
    <script>
        const nombreRecetaInput = document.getElementById('nombreReceta');
        const ingredientesInput = document.getElementById('ingredientes');
        const pasosInput = document.getElementById('pasos');
        const btnEnviarInput = document.getElementById('btnEnviar');

        const divErrorMensaje = document.getElementById("error-message");
        const form = document.getElementById("formRecetas")
        const recetasContainer = document.getElementById("recetasContainer");

        form.addEventListener('submit', function (event) {
            event.preventDefault();

            // Obtener las recetas almacenados en el localStorage
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];

            // Comprobar si ya se ha usado ese nombre de receta
            const recetaExistente = recetas.find(receta => receta.nombre === nombreRecetaInput.value.trim());

            if (recetaExistente) {
                divErrorMensaje.innerHTML = 'Ya hay una receta con ese nombre. Prueba con otro o cámbialo un poco.';
                //divErrorMensaje.style.padding = '1em'
                divErrorMensaje.style.display = 'block'; // Mostrar el mensaje de error
                return;
            }

            // Guardar los datos en localStorage
            const nuevaReceta = {
                nombre: nombreRecetaInput.value,
                ingredientes: ingredientesInput.value,
                pasos: pasosInput.value
            };
            // Agregar la nueva receta al array
            recetas.push(nuevaReceta);

            // Guardar el array actualizado en el localStorage
            localStorage.setItem("recetas", JSON.stringify(recetas));

            // Limpiar campos del formulario
            nombreRecetaInput.value = '';
            ingredientesInput.value = '';
            pasosInput.value = '';

            // Actualizar la visualización de recetas
            renderRecetas();

        });

        //llamo a la función que me pintará las postit
        function renderRecetas() {

            // Vaciar el contenedor de recetas
            recetasContainer.innerHTML = '';

            // Obtener recetas del localStorage
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];

            // Mostrar cada receta
            recetas.forEach((receta, index) => {
                const recetaDiv = document.createElement('div');
                recetaDiv.className = 'receta';

                recetaDiv.innerHTML = `
                    <strong>${receta.nombre}</strong>
                    <p><strong>Ingredientes:</strong> ${receta.ingredientes}</p>
                    <p><strong>Pasos:</strong> ${receta.pasos}</p>
                    <button class="btn-borrar" onclick="eliminarReceta(${index})">Eliminar</button>
                `;

                recetasContainer.appendChild(recetaDiv);
            });
        }

        // Función para eliminar receta
        function eliminarReceta(index) {
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];
            recetas.splice(index, 1); // Eliminar receta por índice
            localStorage.setItem("recetas", JSON.stringify(recetas));

            // Actualizar la visualización de recetas
            renderRecetas();
        }

        // Renderizar recetas al cargar la página
        window.onload = renderRecetas;
    </script>
</body>

</html>