<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recetas</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: rgb(215, 123, 31);
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        }

        h2 {
            text-align: center;
            color: black;
            margin-top: 60px;
        }

        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            margin: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);

        }

        label {
            font-size: 16px;
            margin-bottom: 10px;
            display: block;
        }

        .formato {
            margin-bottom: 2em;
        }

        input[type="text"],
        textarea {
            width: 96%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        input[type="submit"] {
            background-color: #41c7d3;
            color: black;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 30px;
            width: 200px;
            display: inline;

        }

        input[type="submit"]:hover {
            background-color: #0f6f78;
            color: white;
        }

        .receta {
            background-color: #fff;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-borrar {
            background-color: red;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        .btn-borrar:hover {
            background-color: darkred;
        }
    </style>
</head>

<body>
    <header>
        <h1>La venganza de la abuela</h1>
        <!--Aquí va el buscador-->
    </header>
    <main>
        <figure>
            <img src="cuchillo.webp" alt="Imagen de un cuchillo clavado en un tabla de picar verdura">
        </figure>
        <div class="form-container">
            <h2>Cuéntanos tu receta:</h2>
            <form id="formRecetas">
                <input type="text" id="nombreReceta" name="nombreReceta" placeholder="Nombre de la receta" required>
                <div id="error-message" class="error"></div>
                <br><br>
                <textarea id="ingredientes" name="ingredientes" placeholder="Ingredientes" rows="5"
                    cols="50"></textarea>
                <br><br>
                <textarea id="pasos" name="pasos" placeholder="Pasos de preparación" rows="5" cols="50"></textarea>
                <br><br>
                <input type="submit" id="btnEnviar" value="Guardar receta">
            </form>
        </div>
        <h3>Recetas Guardadas</h3>
        <div id="recetasContainer"></div>
    </main>
    <footer>
    </footer>
    <script>
        const nombreRecetaInput = document.getElementById('nombreReceta');
        const ingredientesInput = document.getElementById('ingredientes');
        const pasosInput = document.getElementById('pasos');
        const btnEnviarInput = document.getElementById('btnEnviar');

        const divErrorMensaje = document.getElementById("error-message");
        const form = document.getElementById("formRecetas")
        const recetasContainer = document.getElementById("recetasContainer");

        form.addEventListener('submit', function (event) {
            event.preventDefault();

            // Obtener las recetas almacenados en el localStorage
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];

            // Comprobar si ya se ha usado ese nombre de receta
            const recetaExistente = recetas.find(receta => receta.nombre === nombreRecetaInput.value.trim());

            if (recetaExistente) {
                divErrorMensaje.innerHTML = 'Ya hay una receta con ese nombre. Prueba con otro o cámbialo un poco.';
                divErrorMensaje.style.padding = '1em'
                divErrorMensaje.style.display = 'block'; // Mostrar el mensaje de error
                return;
            }

            // Guardar los datos en localStorage
            const nuevaReceta = {
                nombre: nombreRecetaInput.value,
                ingredientes: ingredientesInput.value,
                pasos: pasosInput.value
            };
            // Agregar la nueva receta al array
            recetas.push(nuevaReceta);

            // Guardar el array actualizado en el localStorage
            localStorage.setItem("recetas", JSON.stringify(recetas));

            // Limpiar campos del formulario
            nombreRecetaInput.value = '';
            ingredientesInput.value = '';
            pasosInput.value = '';

            // Actualizar la visualización de recetas
            renderRecetas();

        });

        //llamo a la función que me pintará las postit
        function renderRecetas() {

            // Vaciar el contenedor de recetas
            recetasContainer.innerHTML = '';

            // Obtener recetas del localStorage
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];

            // Mostrar cada receta
            recetas.forEach((receta, index) => {
                const recetaDiv = document.createElement('div');
                recetaDiv.className = 'receta';

                recetaDiv.innerHTML = `
                    <strong>${receta.nombre}</strong>
                    <p><strong>Ingredientes:</strong> ${receta.ingredientes}</p>
                    <p><strong>Pasos:</strong> ${receta.pasos}</p>
                    <button class="btn-borrar" onclick="eliminarReceta(${index})">Eliminar</button>
                `;

                recetasContainer.appendChild(recetaDiv);
            });
        }

        // Función para eliminar receta
        function eliminarReceta(index) {
            let recetas = JSON.parse(localStorage.getItem("recetas")) || [];
            recetas.splice(index, 1); // Eliminar receta por índice
            localStorage.setItem("recetas", JSON.stringify(recetas));

            // Actualizar la visualización de recetas
            renderRecetas();
        }

        // Renderizar recetas al cargar la página
        window.onload = renderRecetas;
    </script>
</body>

</html>